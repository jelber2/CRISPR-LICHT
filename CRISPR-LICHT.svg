<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: snakemake_dag Pages: 1 -->
<svg width="401pt" height="1026pt"
 viewBox="0.00 0.00 400.50 1026.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1022)">
<title>snakemake_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1022 396.5,-1022 396.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<path fill="none" stroke="#56d86b" stroke-width="2" stroke-dasharray="5,2" d="M264.5,-96C264.5,-96 109.5,-96 109.5,-96 103.5,-96 97.5,-90 97.5,-84 97.5,-84 97.5,-12 97.5,-12 97.5,-6 103.5,0 109.5,0 109.5,0 264.5,0 264.5,0 270.5,0 276.5,-6 276.5,-12 276.5,-12 276.5,-84 276.5,-84 276.5,-90 270.5,-96 264.5,-96"/>
<text text-anchor="middle" x="187" y="-84" font-family="sans" font-size="10.00">ready to estimate log2FC and</text>
<text text-anchor="middle" x="187" y="-73" font-family="sans" font-size="10.00">p values from count table</text>
<text text-anchor="middle" x="187" y="-62" font-family="sans" font-size="10.00">using a negative</text>
<text text-anchor="middle" x="187" y="-51" font-family="sans" font-size="10.00">binomial generlized linear</text>
<text text-anchor="middle" x="187" y="-40" font-family="sans" font-size="10.00">model with a common dispersion</text>
<text text-anchor="middle" x="187" y="-29" font-family="sans" font-size="10.00">estimate and ability to add</text>
<text text-anchor="middle" x="187" y="-18" font-family="sans" font-size="10.00"> covariates such as batch</text>
<text text-anchor="middle" x="187" y="-7" font-family="sans" font-size="10.00">just like DESeq2</text>
</g>
<!-- 2 -->
<g id="node2" class="node">
<title>2</title>
<path fill="none" stroke="#d8a456" stroke-width="2" stroke-dasharray="5,2" d="M256.5,-240C256.5,-240 117.5,-240 117.5,-240 111.5,-240 105.5,-234 105.5,-228 105.5,-228 105.5,-216 105.5,-216 105.5,-210 111.5,-204 117.5,-204 117.5,-204 256.5,-204 256.5,-204 262.5,-204 268.5,-210 268.5,-216 268.5,-216 268.5,-228 268.5,-228 268.5,-234 262.5,-240 256.5,-240"/>
<text text-anchor="middle" x="187" y="-225" font-family="sans" font-size="10.00">use STAR on the filtered reads</text>
<text text-anchor="middle" x="187" y="-214" font-family="sans" font-size="10.00"> to make count table</text>
</g>
<!-- 12 -->
<g id="node12" class="node">
<title>12</title>
<path fill="none" stroke="#d8cb56" stroke-width="2" stroke-dasharray="5,2" d="M261.5,-168C261.5,-168 112.5,-168 112.5,-168 106.5,-168 100.5,-162 100.5,-156 100.5,-156 100.5,-144 100.5,-144 100.5,-138 106.5,-132 112.5,-132 112.5,-132 261.5,-132 261.5,-132 267.5,-132 273.5,-138 273.5,-144 273.5,-144 273.5,-156 273.5,-156 273.5,-162 267.5,-168 261.5,-168"/>
<text text-anchor="middle" x="187" y="-153" font-family="sans" font-size="10.00">convert count table from matrix</text>
<text text-anchor="middle" x="187" y="-142" font-family="sans" font-size="10.00">format to csv format</text>
</g>
<!-- 2&#45;&gt;12 -->
<g id="edge13" class="edge">
<title>2&#45;&gt;12</title>
<path fill="none" stroke="grey" stroke-width="2" d="M187,-203.7C187,-195.98 187,-186.71 187,-178.11"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="190.5,-178.1 187,-168.1 183.5,-178.1 190.5,-178.1"/>
</g>
<!-- 3 -->
<g id="node3" class="node">
<title>3</title>
<path fill="none" stroke="#567bd8" stroke-width="2" stroke-dasharray="5,2" d="M273.5,-312C273.5,-312 100.5,-312 100.5,-312 94.5,-312 88.5,-306 88.5,-300 88.5,-300 88.5,-288 88.5,-288 88.5,-282 94.5,-276 100.5,-276 100.5,-276 273.5,-276 273.5,-276 279.5,-276 285.5,-282 285.5,-288 285.5,-288 285.5,-300 285.5,-300 285.5,-306 279.5,-312 273.5,-312"/>
<text text-anchor="middle" x="187" y="-291.5" font-family="sans" font-size="10.00">convert filtered BAM to filtered reads</text>
</g>
<!-- 3&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>3&#45;&gt;2</title>
<path fill="none" stroke="grey" stroke-width="2" d="M187,-275.7C187,-267.98 187,-258.71 187,-250.11"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="190.5,-250.1 187,-240.1 183.5,-250.1 190.5,-250.1"/>
</g>
<!-- 4 -->
<g id="node4" class="node">
<title>4</title>
<path fill="none" stroke="#56d8b9" stroke-width="2" stroke-dasharray="5,2" d="M259.5,-384C259.5,-384 114.5,-384 114.5,-384 108.5,-384 102.5,-378 102.5,-372 102.5,-372 102.5,-360 102.5,-360 102.5,-354 108.5,-348 114.5,-348 114.5,-348 259.5,-348 259.5,-348 265.5,-348 271.5,-354 271.5,-360 271.5,-360 271.5,-372 271.5,-372 271.5,-378 265.5,-384 259.5,-384"/>
<text text-anchor="middle" x="187" y="-369" font-family="sans" font-size="10.00">filter BAM output from STAR to </text>
<text text-anchor="middle" x="187" y="-358" font-family="sans" font-size="10.00">get rid of mismatches</text>
</g>
<!-- 4&#45;&gt;3 -->
<g id="edge4" class="edge">
<title>4&#45;&gt;3</title>
<path fill="none" stroke="grey" stroke-width="2" d="M187,-347.7C187,-339.98 187,-330.71 187,-322.11"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="190.5,-322.1 187,-312.1 183.5,-322.1 190.5,-322.1"/>
</g>
<!-- 5 -->
<g id="node5" class="node">
<title>5</title>
<path fill="none" stroke="#d85656" stroke-width="2" stroke-dasharray="5,2" d="M267,-461C267,-461 107,-461 107,-461 101,-461 95,-455 95,-449 95,-449 95,-432 95,-432 95,-426 101,-420 107,-420 107,-420 267,-420 267,-420 273,-420 279,-426 279,-432 279,-432 279,-449 279,-449 279,-455 273,-461 267,-461"/>
<text text-anchor="middle" x="187" y="-449" font-family="sans" font-size="10.00">use STAR to estimate mismatches</text>
<text text-anchor="middle" x="187" y="-438" font-family="sans" font-size="10.00">between reads and gRNAs</text>
<text text-anchor="middle" x="187" y="-427" font-family="sans" font-size="10.00">no introns allowed</text>
</g>
<!-- 5&#45;&gt;4 -->
<g id="edge5" class="edge">
<title>5&#45;&gt;4</title>
<path fill="none" stroke="grey" stroke-width="2" d="M187,-419.69C187,-411.91 187,-402.84 187,-394.45"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="190.5,-394.32 187,-384.32 183.5,-394.32 190.5,-394.32"/>
</g>
<!-- 6 -->
<g id="node6" class="node">
<title>6</title>
<path fill="none" stroke="#68d856" stroke-width="2" stroke-dasharray="5,2" d="M197,-605C197,-605 75,-605 75,-605 69,-605 63,-599 63,-593 63,-593 63,-581 63,-581 63,-575 69,-569 75,-569 75,-569 197,-569 197,-569 203,-569 209,-575 209,-581 209,-581 209,-593 209,-593 209,-599 203,-605 197,-605"/>
<text text-anchor="middle" x="136" y="-584.5" font-family="sans" font-size="10.00">convert to format for STAR</text>
</g>
<!-- 6&#45;&gt;5 -->
<g id="edge6" class="edge">
<title>6&#45;&gt;5</title>
<path fill="none" stroke="grey" stroke-width="2" d="M148.55,-568.63C155.22,-558.64 163.05,-545.61 168,-533 175.78,-513.18 180.58,-489.63 183.4,-471.39"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="186.89,-471.73 184.85,-461.33 179.96,-470.73 186.89,-471.73"/>
</g>
<!-- 11 -->
<g id="node11" class="node">
<title>11</title>
<path fill="none" stroke="#d87d56" stroke-width="2" stroke-dasharray="5,2" d="M147,-533C147,-533 23,-533 23,-533 17,-533 11,-527 11,-521 11,-521 11,-509 11,-509 11,-503 17,-497 23,-497 23,-497 147,-497 147,-497 153,-497 159,-503 159,-509 159,-509 159,-521 159,-521 159,-527 153,-533 147,-533"/>
<text text-anchor="middle" x="85" y="-512.5" font-family="sans" font-size="10.00">make barcode list for STAR</text>
</g>
<!-- 6&#45;&gt;11 -->
<g id="edge12" class="edge">
<title>6&#45;&gt;11</title>
<path fill="none" stroke="grey" stroke-width="2" d="M123.39,-568.7C117.4,-560.47 110.12,-550.48 103.52,-541.42"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="106.18,-539.13 97.46,-533.1 100.52,-543.25 106.18,-539.13"/>
</g>
<!-- 7 -->
<g id="node7" class="node">
<title>7</title>
<path fill="none" stroke="#b6d856" stroke-width="2" stroke-dasharray="5,2" d="M195.5,-677C195.5,-677 76.5,-677 76.5,-677 70.5,-677 64.5,-671 64.5,-665 64.5,-665 64.5,-653 64.5,-653 64.5,-647 70.5,-641 76.5,-641 76.5,-641 195.5,-641 195.5,-641 201.5,-641 207.5,-647 207.5,-653 207.5,-653 207.5,-665 207.5,-665 207.5,-671 201.5,-677 195.5,-677"/>
<text text-anchor="middle" x="136" y="-662" font-family="sans" font-size="10.00">combine 16 outputs from </text>
<text text-anchor="middle" x="136" y="-651" font-family="sans" font-size="10.00">umi_tools extract</text>
</g>
<!-- 7&#45;&gt;6 -->
<g id="edge8" class="edge">
<title>7&#45;&gt;6</title>
<path fill="none" stroke="grey" stroke-width="2" d="M136,-640.7C136,-632.98 136,-623.71 136,-615.11"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="139.5,-615.1 136,-605.1 132.5,-615.1 139.5,-615.1"/>
</g>
<!-- 8 -->
<g id="node8" class="node">
<title>8</title>
<path fill="none" stroke="#56d892" stroke-width="2" stroke-dasharray="5,2" d="M207.5,-765C207.5,-765 64.5,-765 64.5,-765 58.5,-765 52.5,-759 52.5,-753 52.5,-753 52.5,-725 52.5,-725 52.5,-719 58.5,-713 64.5,-713 64.5,-713 207.5,-713 207.5,-713 213.5,-713 219.5,-719 219.5,-725 219.5,-725 219.5,-753 219.5,-753 219.5,-759 213.5,-765 207.5,-765"/>
<text text-anchor="middle" x="136" y="-753" font-family="sans" font-size="10.00">use umi_tools extract on each </text>
<text text-anchor="middle" x="136" y="-742" font-family="sans" font-size="10.00">of the 16 input files</text>
<text text-anchor="middle" x="136" y="-731" font-family="sans" font-size="10.00"> and the whitelist</text>
<text text-anchor="middle" x="136" y="-720" font-family="sans" font-size="10.00">to correct barcodes</text>
</g>
<!-- 8&#45;&gt;7 -->
<g id="edge9" class="edge">
<title>8&#45;&gt;7</title>
<path fill="none" stroke="grey" stroke-width="2" d="M136,-712.89C136,-704.84 136,-695.88 136,-687.66"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="139.5,-687.41 136,-677.41 132.5,-687.41 139.5,-687.41"/>
</g>
<!-- 9 -->
<g id="node9" class="node">
<title>9</title>
<path fill="none" stroke="#8fd856" stroke-width="2" stroke-dasharray="5,2" d="M110,-858.5C110,-858.5 12,-858.5 12,-858.5 6,-858.5 0,-852.5 0,-846.5 0,-846.5 0,-829.5 0,-829.5 0,-823.5 6,-817.5 12,-817.5 12,-817.5 110,-817.5 110,-817.5 116,-817.5 122,-823.5 122,-829.5 122,-829.5 122,-846.5 122,-846.5 122,-852.5 116,-858.5 110,-858.5"/>
<text text-anchor="middle" x="61" y="-846.5" font-family="sans" font-size="10.00">split the original files</text>
<text text-anchor="middle" x="61" y="-835.5" font-family="sans" font-size="10.00">into 16 pieces for</text>
<text text-anchor="middle" x="61" y="-824.5" font-family="sans" font-size="10.00">16x faster processing</text>
</g>
<!-- 9&#45;&gt;8 -->
<g id="edge10" class="edge">
<title>9&#45;&gt;8</title>
<path fill="none" stroke="grey" stroke-width="2" d="M76.18,-817.37C86,-804.67 99.04,-787.81 110.43,-773.07"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="113.22,-775.19 116.56,-765.14 107.68,-770.91 113.22,-775.19"/>
</g>
<!-- 10 -->
<g id="node10" class="node">
<title>10</title>
<path fill="none" stroke="#56d0d8" stroke-width="2" stroke-dasharray="5,2" d="M269.5,-875C269.5,-875 152.5,-875 152.5,-875 146.5,-875 140.5,-869 140.5,-863 140.5,-863 140.5,-813 140.5,-813 140.5,-807 146.5,-801 152.5,-801 152.5,-801 269.5,-801 269.5,-801 275.5,-801 281.5,-807 281.5,-813 281.5,-813 281.5,-863 281.5,-863 281.5,-869 275.5,-875 269.5,-875"/>
<text text-anchor="middle" x="211" y="-863" font-family="sans" font-size="10.00">use umi_tools whitelist</text>
<text text-anchor="middle" x="211" y="-852" font-family="sans" font-size="10.00">on original reads</text>
<text text-anchor="middle" x="211" y="-841" font-family="sans" font-size="10.00">with up to 3 errors</text>
<text text-anchor="middle" x="211" y="-830" font-family="sans" font-size="10.00">in combined 20&#45;bp</text>
<text text-anchor="middle" x="211" y="-819" font-family="sans" font-size="10.00">sample*lineage barcodes</text>
<text text-anchor="middle" x="211" y="-808" font-family="sans" font-size="10.00">to make a whitelist</text>
</g>
<!-- 10&#45;&gt;8 -->
<g id="edge11" class="edge">
<title>10&#45;&gt;8</title>
<path fill="none" stroke="grey" stroke-width="2" d="M183.07,-800.88C176.06,-791.81 168.56,-782.12 161.67,-773.19"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="164.41,-771.03 155.53,-765.26 158.88,-775.31 164.41,-771.03"/>
</g>
<!-- 11&#45;&gt;2 -->
<g id="edge3" class="edge">
<title>11&#45;&gt;2</title>
<path fill="none" stroke="grey" stroke-width="2" d="M78.63,-496.78C64.4,-455.14 34.62,-347.21 79,-276 87.51,-262.35 100.67,-252.11 114.92,-244.48"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="116.48,-247.61 123.9,-240.05 113.38,-241.33 116.48,-247.61"/>
</g>
<!-- 11&#45;&gt;5 -->
<g id="edge7" class="edge">
<title>11&#45;&gt;5</title>
<path fill="none" stroke="grey" stroke-width="2" d="M109.17,-496.82C121.66,-487.94 137.15,-476.93 151.02,-467.08"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="153.27,-469.77 159.4,-461.12 149.22,-464.06 153.27,-469.77"/>
</g>
<!-- 12&#45;&gt;0 -->
<g id="edge1" class="edge">
<title>12&#45;&gt;0</title>
<path fill="none" stroke="grey" stroke-width="2" d="M187,-131.58C187,-124.35 187,-115.51 187,-106.32"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="190.5,-106.29 187,-96.29 183.5,-106.29 190.5,-106.29"/>
</g>
<!-- 13 -->
<g id="node13" class="node">
<title>13</title>
<path fill="none" stroke="#d8cb56" stroke-width="2" stroke-dasharray="5,2" d="M206,-1018C206,-1018 66,-1018 66,-1018 60,-1018 54,-1012 54,-1006 54,-1006 54,-923 54,-923 54,-917 60,-911 66,-911 66,-911 206,-911 206,-911 212,-911 218,-917 218,-923 218,-923 218,-1006 218,-1006 218,-1012 212,-1018 206,-1018"/>
<text text-anchor="middle" x="136" y="-1006" font-family="sans" font-size="10.00">get original reads</text>
<text text-anchor="middle" x="136" y="-995" font-family="sans" font-size="10.00">Index1: 10&#45;bp lineage barcode</text>
<text text-anchor="middle" x="136" y="-984" font-family="sans" font-size="10.00">Index2: 10&#45;bp sample barcode</text>
<text text-anchor="middle" x="136" y="-973" font-family="sans" font-size="10.00">R1 (51&#45;bp total):</text>
<text text-anchor="middle" x="136" y="-962" font-family="sans" font-size="10.00">12&#45;bp UMI,</text>
<text text-anchor="middle" x="136" y="-951" font-family="sans" font-size="10.00">some random seq,</text>
<text text-anchor="middle" x="136" y="-940" font-family="sans" font-size="10.00">a constant seq,</text>
<text text-anchor="middle" x="136" y="-929" font-family="sans" font-size="10.00">immediately followed by</text>
<text text-anchor="middle" x="136" y="-918" font-family="sans" font-size="10.00">the 19&#45;20&#45;bp gRNA</text>
</g>
<!-- 13&#45;&gt;9 -->
<g id="edge14" class="edge">
<title>13&#45;&gt;9</title>
<path fill="none" stroke="grey" stroke-width="2" d="M104.19,-910.7C95.26,-895.88 85.89,-880.32 78.17,-867.5"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="81.02,-865.45 72.86,-858.7 75.03,-869.07 81.02,-865.45"/>
</g>
<!-- 13&#45;&gt;10 -->
<g id="edge15" class="edge">
<title>13&#45;&gt;10</title>
<path fill="none" stroke="grey" stroke-width="2" d="M167.81,-910.7C173.14,-901.85 178.63,-892.73 183.83,-884.09"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="186.97,-885.67 189.13,-875.3 180.98,-882.06 186.97,-885.67"/>
</g>
<!-- 14 -->
<g id="node14" class="node">
<title>14</title>
<path fill="none" stroke="#d8cb56" stroke-width="2" stroke-dasharray="5,2" d="M380.5,-533C380.5,-533 233.5,-533 233.5,-533 227.5,-533 221.5,-527 221.5,-521 221.5,-521 221.5,-509 221.5,-509 221.5,-503 227.5,-497 233.5,-497 233.5,-497 380.5,-497 380.5,-497 386.5,-497 392.5,-503 392.5,-509 392.5,-509 392.5,-521 392.5,-521 392.5,-527 386.5,-533 380.5,-533"/>
<text text-anchor="middle" x="307" y="-518" font-family="sans" font-size="10.00">make a sequence reference for </text>
<text text-anchor="middle" x="307" y="-507" font-family="sans" font-size="10.00">STAR using the gRNAs</text>
</g>
<!-- 14&#45;&gt;2 -->
<g id="edge16" class="edge">
<title>14&#45;&gt;2</title>
<path fill="none" stroke="grey" stroke-width="2" d="M311.43,-496.95C321.22,-455.23 340.34,-346.31 294,-276 285.03,-262.38 271.46,-252.13 256.98,-244.46"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="258.39,-241.26 247.87,-240.01 255.32,-247.54 258.39,-241.26"/>
</g>
<!-- 14&#45;&gt;5 -->
<g id="edge17" class="edge">
<title>14&#45;&gt;5</title>
<path fill="none" stroke="grey" stroke-width="2" d="M278.56,-496.82C263.59,-487.77 244.96,-476.52 228.41,-466.52"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="229.84,-463.3 219.47,-461.12 226.22,-469.29 229.84,-463.3"/>
</g>
</g>
</svg>
