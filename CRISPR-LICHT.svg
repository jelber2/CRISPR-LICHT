<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: snakemake_dag Pages: 1 -->
<svg width="550pt" height="900pt"
 viewBox="0.00 0.00 550.00 900.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 896)">
<title>snakemake_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-896 546,-896 546,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<path fill="none" stroke="#56d86b" stroke-width="2" stroke-dasharray="5,2" d="M360,-36C360,-36 178,-36 178,-36 172,-36 166,-30 166,-24 166,-24 166,-12 166,-12 166,-6 172,0 178,0 178,0 360,0 360,0 366,0 372,-6 372,-12 372,-12 372,-24 372,-24 372,-30 366,-36 360,-36"/>
<text text-anchor="middle" x="269" y="-21" font-family="sans" font-size="10.00">ready to estimate log2FC and p values</text>
<text text-anchor="middle" x="269" y="-10" font-family="sans" font-size="10.00"> from count table</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<path fill="none" stroke="#56a9d8" stroke-width="2" stroke-dasharray="5,2" d="M243.5,-108C243.5,-108 16.5,-108 16.5,-108 10.5,-108 4.5,-102 4.5,-96 4.5,-96 4.5,-84 4.5,-84 4.5,-78 10.5,-72 16.5,-72 16.5,-72 243.5,-72 243.5,-72 249.5,-72 255.5,-78 255.5,-84 255.5,-84 255.5,-96 255.5,-96 255.5,-102 249.5,-108 243.5,-108"/>
<text text-anchor="middle" x="130" y="-87.5" font-family="sans" font-size="10.00">convert matrix to csv file for STARsolo raw data</text>
</g>
<!-- 1&#45;&gt;0 -->
<g id="edge1" class="edge">
<title>1&#45;&gt;0</title>
<path fill="none" stroke="grey" stroke-width="2" d="M164,-71.88C182.6,-62.51 205.83,-50.81 225.71,-40.8"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="227.51,-43.81 234.87,-36.19 224.36,-37.56 227.51,-43.81"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<path fill="none" stroke="#d8a456" stroke-width="2" stroke-dasharray="5,2" d="M339,-180C339,-180 199,-180 199,-180 193,-180 187,-174 187,-168 187,-168 187,-156 187,-156 187,-150 193,-144 199,-144 199,-144 339,-144 339,-144 345,-144 351,-150 351,-156 351,-156 351,-168 351,-168 351,-174 345,-180 339,-180"/>
<text text-anchor="middle" x="269" y="-165" font-family="sans" font-size="10.00">use STAR on the filtered reads</text>
<text text-anchor="middle" x="269" y="-154" font-family="sans" font-size="10.00"> to make count table</text>
</g>
<!-- 2&#45;&gt;1 -->
<g id="edge3" class="edge">
<title>2&#45;&gt;1</title>
<path fill="none" stroke="grey" stroke-width="2" d="M235,-143.88C216.4,-134.51 193.17,-122.81 173.29,-112.8"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="174.64,-109.56 164.13,-108.19 171.49,-115.81 174.64,-109.56"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<path fill="none" stroke="#d8cb56" stroke-width="2" stroke-dasharray="5,2" d="M530,-108C530,-108 286,-108 286,-108 280,-108 274,-102 274,-96 274,-96 274,-84 274,-84 274,-78 280,-72 286,-72 286,-72 530,-72 530,-72 536,-72 542,-78 542,-84 542,-84 542,-96 542,-96 542,-102 536,-108 530,-108"/>
<text text-anchor="middle" x="408" y="-87.5" font-family="sans" font-size="10.00">convert matrix to csv file for STARsolo filtered data</text>
</g>
<!-- 2&#45;&gt;12 -->
<g id="edge15" class="edge">
<title>2&#45;&gt;12</title>
<path fill="none" stroke="grey" stroke-width="2" d="M303,-143.88C321.6,-134.51 344.83,-122.81 364.71,-112.8"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="366.51,-115.81 373.87,-108.19 363.36,-109.56 366.51,-115.81"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<path fill="none" stroke="#567bd8" stroke-width="2" stroke-dasharray="5,2" d="M356,-252C356,-252 182,-252 182,-252 176,-252 170,-246 170,-240 170,-240 170,-228 170,-228 170,-222 176,-216 182,-216 182,-216 356,-216 356,-216 362,-216 368,-222 368,-228 368,-228 368,-240 368,-240 368,-246 362,-252 356,-252"/>
<text text-anchor="middle" x="269" y="-231.5" font-family="sans" font-size="10.00">convert filtered BAM to filtered reads</text>
</g>
<!-- 3&#45;&gt;2 -->
<g id="edge4" class="edge">
<title>3&#45;&gt;2</title>
<path fill="none" stroke="grey" stroke-width="2" d="M269,-215.7C269,-207.98 269,-198.71 269,-190.11"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="272.5,-190.1 269,-180.1 265.5,-190.1 272.5,-190.1"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<path fill="none" stroke="#56d8b9" stroke-width="2" stroke-dasharray="5,2" d="M342,-324C342,-324 196,-324 196,-324 190,-324 184,-318 184,-312 184,-312 184,-300 184,-300 184,-294 190,-288 196,-288 196,-288 342,-288 342,-288 348,-288 354,-294 354,-300 354,-300 354,-312 354,-312 354,-318 348,-324 342,-324"/>
<text text-anchor="middle" x="269" y="-309" font-family="sans" font-size="10.00">filter BAM output from STAR to </text>
<text text-anchor="middle" x="269" y="-298" font-family="sans" font-size="10.00">get rid of mismatches</text>
</g>
<!-- 4&#45;&gt;3 -->
<g id="edge6" class="edge">
<title>4&#45;&gt;3</title>
<path fill="none" stroke="grey" stroke-width="2" d="M269,-287.7C269,-279.98 269,-270.71 269,-262.11"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="272.5,-262.1 269,-252.1 265.5,-262.1 272.5,-262.1"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<path fill="none" stroke="#d85656" stroke-width="2" stroke-dasharray="5,2" d="M372,-401C372,-401 166,-401 166,-401 160,-401 154,-395 154,-389 154,-389 154,-372 154,-372 154,-366 160,-360 166,-360 166,-360 372,-360 372,-360 378,-360 384,-366 384,-372 384,-372 384,-389 384,-389 384,-395 378,-401 372,-401"/>
<text text-anchor="middle" x="269" y="-389" font-family="sans" font-size="10.00">use STAR to estimate mismatches between</text>
<text text-anchor="middle" x="269" y="-378" font-family="sans" font-size="10.00"> reads and gRNAs</text>
<text text-anchor="middle" x="269" y="-367" font-family="sans" font-size="10.00">no introns allowed</text>
</g>
<!-- 5&#45;&gt;4 -->
<g id="edge7" class="edge">
<title>5&#45;&gt;4</title>
<path fill="none" stroke="grey" stroke-width="2" d="M269,-359.69C269,-351.91 269,-342.84 269,-334.45"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="272.5,-334.32 269,-324.32 265.5,-334.32 272.5,-334.32"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<path fill="none" stroke="#68d856" stroke-width="2" stroke-dasharray="5,2" d="M268.5,-545C268.5,-545 145.5,-545 145.5,-545 139.5,-545 133.5,-539 133.5,-533 133.5,-533 133.5,-521 133.5,-521 133.5,-515 139.5,-509 145.5,-509 145.5,-509 268.5,-509 268.5,-509 274.5,-509 280.5,-515 280.5,-521 280.5,-521 280.5,-533 280.5,-533 280.5,-539 274.5,-545 268.5,-545"/>
<text text-anchor="middle" x="207" y="-524.5" font-family="sans" font-size="10.00">convert to format for STAR</text>
</g>
<!-- 6&#45;&gt;5 -->
<g id="edge8" class="edge">
<title>6&#45;&gt;5</title>
<path fill="none" stroke="grey" stroke-width="2" d="M224.48,-508.85C233.41,-499.12 243.7,-486.27 250,-473 259.19,-453.64 263.95,-429.9 266.41,-411.46"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="269.92,-411.62 267.61,-401.28 262.97,-410.8 269.92,-411.62"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<path fill="none" stroke="#d87d56" stroke-width="2" stroke-dasharray="5,2" d="M229,-473C229,-473 63,-473 63,-473 57,-473 51,-467 51,-461 51,-461 51,-449 51,-449 51,-443 57,-437 63,-437 63,-437 229,-437 229,-437 235,-437 241,-443 241,-449 241,-449 241,-461 241,-461 241,-467 235,-473 229,-473"/>
<text text-anchor="middle" x="146" y="-452.5" font-family="sans" font-size="10.00">make a list of indexes for STARsolo</text>
</g>
<!-- 6&#45;&gt;11 -->
<g id="edge14" class="edge">
<title>6&#45;&gt;11</title>
<path fill="none" stroke="grey" stroke-width="2" d="M191.92,-508.7C184.61,-500.3 175.69,-490.07 167.66,-480.86"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="170.11,-478.34 160.91,-473.1 164.84,-482.94 170.11,-478.34"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<path fill="none" stroke="#b6d856" stroke-width="2" stroke-dasharray="5,2" d="M266.5,-617C266.5,-617 147.5,-617 147.5,-617 141.5,-617 135.5,-611 135.5,-605 135.5,-605 135.5,-593 135.5,-593 135.5,-587 141.5,-581 147.5,-581 147.5,-581 266.5,-581 266.5,-581 272.5,-581 278.5,-587 278.5,-593 278.5,-593 278.5,-605 278.5,-605 278.5,-611 272.5,-617 266.5,-617"/>
<text text-anchor="middle" x="207" y="-602" font-family="sans" font-size="10.00">combine 16 outputs from </text>
<text text-anchor="middle" x="207" y="-591" font-family="sans" font-size="10.00">umi_tools extract</text>
</g>
<!-- 7&#45;&gt;6 -->
<g id="edge10" class="edge">
<title>7&#45;&gt;6</title>
<path fill="none" stroke="grey" stroke-width="2" d="M207,-580.7C207,-572.98 207,-563.71 207,-555.11"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="210.5,-555.1 207,-545.1 203.5,-555.1 210.5,-555.1"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<path fill="none" stroke="#56d892" stroke-width="2" stroke-dasharray="5,2" d="M292.5,-705C292.5,-705 121.5,-705 121.5,-705 115.5,-705 109.5,-699 109.5,-693 109.5,-693 109.5,-665 109.5,-665 109.5,-659 115.5,-653 121.5,-653 121.5,-653 292.5,-653 292.5,-653 298.5,-653 304.5,-659 304.5,-665 304.5,-665 304.5,-693 304.5,-693 304.5,-699 298.5,-705 292.5,-705"/>
<text text-anchor="middle" x="207" y="-693" font-family="sans" font-size="10.00">use umi_tools extract on each of the</text>
<text text-anchor="middle" x="207" y="-682" font-family="sans" font-size="10.00">16 input files</text>
<text text-anchor="middle" x="207" y="-671" font-family="sans" font-size="10.00"> and the whitelist</text>
<text text-anchor="middle" x="207" y="-660" font-family="sans" font-size="10.00">to correct indexes</text>
</g>
<!-- 8&#45;&gt;7 -->
<g id="edge11" class="edge">
<title>8&#45;&gt;7</title>
<path fill="none" stroke="grey" stroke-width="2" d="M207,-652.89C207,-644.84 207,-635.88 207,-627.66"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="210.5,-627.41 207,-617.41 203.5,-627.41 210.5,-627.41"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<path fill="none" stroke="#8fd856" stroke-width="2" stroke-dasharray="5,2" d="M176,-785C176,-785 12,-785 12,-785 6,-785 0,-779 0,-773 0,-773 0,-761 0,-761 0,-755 6,-749 12,-749 12,-749 176,-749 176,-749 182,-749 188,-755 188,-761 188,-761 188,-773 188,-773 188,-779 182,-785 176,-785"/>
<text text-anchor="middle" x="94" y="-770" font-family="sans" font-size="10.00">split the original files into</text>
<text text-anchor="middle" x="94" y="-759" font-family="sans" font-size="10.00">16 pieces for 16x faster processing</text>
</g>
<!-- 9&#45;&gt;8 -->
<g id="edge12" class="edge">
<title>9&#45;&gt;8</title>
<path fill="none" stroke="grey" stroke-width="2" d="M116.6,-748.8C130.65,-738.1 149.16,-724.02 165.76,-711.39"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="167.89,-714.16 173.73,-705.32 163.65,-708.59 167.89,-714.16"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<path fill="none" stroke="#56d0d8" stroke-width="2" stroke-dasharray="5,2" d="M423.5,-793C423.5,-793 218.5,-793 218.5,-793 212.5,-793 206.5,-787 206.5,-781 206.5,-781 206.5,-753 206.5,-753 206.5,-747 212.5,-741 218.5,-741 218.5,-741 423.5,-741 423.5,-741 429.5,-741 435.5,-747 435.5,-753 435.5,-753 435.5,-781 435.5,-781 435.5,-787 429.5,-793 423.5,-793"/>
<text text-anchor="middle" x="321" y="-781" font-family="sans" font-size="10.00">use umi_tools whitelist</text>
<text text-anchor="middle" x="321" y="-770" font-family="sans" font-size="10.00">on original reads</text>
<text text-anchor="middle" x="321" y="-759" font-family="sans" font-size="10.00">with up to 3 errors</text>
<text text-anchor="middle" x="321" y="-748" font-family="sans" font-size="10.00">in combined 20&#45;bp sample*lineage indexes</text>
</g>
<!-- 10&#45;&gt;8 -->
<g id="edge13" class="edge">
<title>10&#45;&gt;8</title>
<path fill="none" stroke="grey" stroke-width="2" d="M287.72,-740.89C275.54,-731.7 261.59,-721.18 248.76,-711.5"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="250.61,-708.51 240.52,-705.29 246.39,-714.1 250.61,-708.51"/>
</g>
<!-- 11&#45;&gt;2 -->
<g id="edge5" class="edge">
<title>11&#45;&gt;2</title>
<path fill="none" stroke="grey" stroke-width="2" d="M141.52,-436.77C131.65,-394.66 112.55,-284.93 161,-216 170.55,-202.42 184.58,-192.16 199.39,-184.47"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="201.18,-187.49 208.68,-180.01 198.15,-181.18 201.18,-187.49"/>
</g>
<!-- 11&#45;&gt;5 -->
<g id="edge9" class="edge">
<title>11&#45;&gt;5</title>
<path fill="none" stroke="grey" stroke-width="2" d="M175.15,-436.82C190.64,-427.69 209.95,-416.31 227.02,-406.24"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="228.88,-409.21 235.71,-401.12 225.32,-403.18 228.88,-409.21"/>
</g>
<!-- 12&#45;&gt;0 -->
<g id="edge2" class="edge">
<title>12&#45;&gt;0</title>
<path fill="none" stroke="grey" stroke-width="2" d="M374,-71.88C355.4,-62.51 332.17,-50.81 312.29,-40.8"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="313.64,-37.56 303.13,-36.19 310.49,-43.81 313.64,-37.56"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<path fill="none" stroke="#d8cb56" stroke-width="2" stroke-dasharray="5,2" d="M340.5,-892C340.5,-892 73.5,-892 73.5,-892 67.5,-892 61.5,-886 61.5,-880 61.5,-880 61.5,-841 61.5,-841 61.5,-835 67.5,-829 73.5,-829 73.5,-829 340.5,-829 340.5,-829 346.5,-829 352.5,-835 352.5,-841 352.5,-841 352.5,-880 352.5,-880 352.5,-886 346.5,-892 340.5,-892"/>
<text text-anchor="middle" x="207" y="-880" font-family="sans" font-size="10.00">get original reads</text>
<text text-anchor="middle" x="207" y="-869" font-family="sans" font-size="10.00">Index1 is 10&#45;bp lineage barcode</text>
<text text-anchor="middle" x="207" y="-858" font-family="sans" font-size="10.00">Index2 is 10&#45;bp sample barcode</text>
<text text-anchor="middle" x="207" y="-847" font-family="sans" font-size="10.00">R1 (51&#45;bp) is 12&#45;bp UMI some random seq, constant seq</text>
<text text-anchor="middle" x="207" y="-836" font-family="sans" font-size="10.00">, immediately followed by 19&#45;20&#45;bp gRNA</text>
</g>
<!-- 13&#45;&gt;9 -->
<g id="edge16" class="edge">
<title>13&#45;&gt;9</title>
<path fill="none" stroke="grey" stroke-width="2" d="M169.06,-828.78C154.05,-816.63 137.08,-802.88 123.07,-791.54"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="125.18,-788.75 115.21,-785.17 120.78,-794.19 125.18,-788.75"/>
</g>
<!-- 13&#45;&gt;10 -->
<g id="edge17" class="edge">
<title>13&#45;&gt;10</title>
<path fill="none" stroke="grey" stroke-width="2" d="M245.28,-828.78C257.05,-819.33 270.02,-808.92 281.85,-799.42"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="284.22,-802.01 289.83,-793.02 279.84,-796.55 284.22,-802.01"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<path fill="none" stroke="#d8cb56" stroke-width="2" stroke-dasharray="5,2" d="M490.5,-473C490.5,-473 317.5,-473 317.5,-473 311.5,-473 305.5,-467 305.5,-461 305.5,-461 305.5,-449 305.5,-449 305.5,-443 311.5,-437 317.5,-437 317.5,-437 490.5,-437 490.5,-437 496.5,-437 502.5,-443 502.5,-449 502.5,-449 502.5,-461 502.5,-461 502.5,-467 496.5,-473 490.5,-473"/>
<text text-anchor="middle" x="404" y="-458" font-family="sans" font-size="10.00">make a sequence reference for STAR</text>
<text text-anchor="middle" x="404" y="-447" font-family="sans" font-size="10.00"> using the gRNAs</text>
</g>
<!-- 14&#45;&gt;2 -->
<g id="edge18" class="edge">
<title>14&#45;&gt;2</title>
<path fill="none" stroke="grey" stroke-width="2" d="M407.21,-436.81C414.05,-394.77 425.74,-285.18 377,-216 367.44,-202.43 353.4,-192.17 338.58,-184.48"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="339.82,-181.2 329.29,-180.02 336.79,-187.51 339.82,-181.2"/>
</g>
<!-- 14&#45;&gt;5 -->
<g id="edge19" class="edge">
<title>14&#45;&gt;5</title>
<path fill="none" stroke="grey" stroke-width="2" d="M372.01,-436.82C354.85,-427.61 333.42,-416.1 314.56,-405.97"/>
<polygon fill="grey" stroke="grey" stroke-width="2" points="316,-402.77 305.53,-401.12 312.69,-408.93 316,-402.77"/>
</g>
</g>
</svg>
